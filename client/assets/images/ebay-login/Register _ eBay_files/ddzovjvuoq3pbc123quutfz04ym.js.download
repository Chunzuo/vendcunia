var FormInputStates={INACTIVE:"inactive",VALID:"valid",ERROR:"error",ACTIVE:"active"},FormType={PROACTIVE:"proactive",REACTIVE:"reactive"},PolyfillAttributes={STATE:"state",BASIC_VALIDATION_PASSED:"basicValidationPassed"};
raptor.defineClass("FormHandler",function(){var h=function(a){var b=raptor.require("FormUtils");a.formUtils=new b;b=raptor.require("TrackingUtils");a.trackingUtils=new b;a.keys={ENTER:13,TAB:9,SHIFT:16,SPACE:32};this.attachHandlers(a)};h.prototype={attachHandlers:function(a){a.mandatoryFields=a.mandatoryFields.split(",");a.fields=a.fields.split(",");a.errorDivs&&(a.errorDivs=JSON.parse(a.errorDivs));a.aliasFieldsForStatusErr&&(a.aliasFieldsForStatusErr=JSON.parse(a.aliasFieldsForStatusErr));if(a.fieldValidatorClass){var b=
new (raptor.require(a.fieldValidatorClass));a.validators=b.validators;b.attachAdditionalHandlers&&b.attachAdditionalHandlers();b.basicValidators&&(a.basicValidators=b.basicValidators)}a.trackingInfo&&(a.trackingInfo=a.trackingInfo.replace(/\'/g,'"'),a.trackingInfo=JSON.parse(a.trackingInfo));void 0===a.formType&&(a.formType=FormType.PROACTIVE);a.formSubmitted=!1;a.validationCallTimeout=null;a.validationHappeningForSubmit=!1;a.validationAjaxStarted=!1;this.cfg=a;this.attachDocumentReadyHandler(a);
this.attachFormInputBlurHandler(a);this.attachFormInputFocusHandler(a);this.attachFormInputKeyPressHandler(a);this.attachFormCheckboxInputHandlers(a);this.attachFormInputKeyUpHandler(a);this.attachFormInputStateChangeHandler(a);this.attachFormSubmitButtonFocusHandler(a);this.attachFormSubmitHandler(a);this.setIntialFormInputState(a);this.trackPageLoad(a)},trackPageLoad:function(a){$("form#"+a.formName).is(":visible")&&a.trackingInfo&&("true"==a.trackingInfo.isRaptorRegTrack&&"false"==a.trackingInfo.isPageReloadOnError)&&
a.trackingUtils.triggerRegTracking(a.trackingInfo)},attachDocumentReadyHandler:function(a){var b=this;$(document).ready(function(){b.checkSize();$(".socWrap").height($(".ppa-col").outerHeight());$(window).resize(b.checkSize);if(!a.isUpgrade&&($("form#"+a.formName).find("input#captcha_Ipt").parent().parent().find("div[class='err']").attr("id","captcha_err"),$("form#"+a.formName).find("input#captcha_BIZREG_Ipt").parent().parent().find("div[class='err']").attr("id","captcha_BIZREG_err"),"undefined"!==
typeof captchaInvalid&&captchaInvalid)){var c=document.querySelector("form#"+a.formName+" input#"+captchaId);c&&a.formUtils.setPolyfillAttributeValue(c,PolyfillAttributes.STATE,FormInputStates.ERROR)}a.isUpgrade&&($("select").each(function(b,c){a.formUtils.setDropdownColor(c)}),$("select").on("change",function(){a.formUtils.setDropdownColor(this)}));$("#statErr").is(":visible")&&($("#ertx").attr("aria-label",$("#statErr").text()),setTimeout(function(){$("#ertx").focus()},0));b.handleTrackOnChangeFields(a);
a.previousFormFieldValues={};a.formType===FormType.REACTIVE&&a.formUtils.showLabelsWhenPlaceholderUnsupported()})},checkSize:function(){var a=$("#mainContent"),b=$("#mainContent .soc-col"),c=$("#mainContent .socWrap");"block"==c.css("display")&&b.hasClass("socUp")?(b.insertAfter(c),b.addClass("socDn").removeClass("socUp")):"block"!=c.css("display")&&b.hasClass("socDn")&&(b.insertBefore($(".ppa-col",a)),b.addClass("socUp").removeClass("socDn"))},setIntialFormInputState:function(a){jQuery.each(a.mandatoryFields,
function(b,c){var d=document.querySelector("form#"+a.formName+" #"+c),f=a.formUtils.getPolyfillAttributeValue(d,PolyfillAttributes.STATE);if(d&&f!==FormInputStates.ERROR){var f=FormInputStates.INACTIVE,e=$(d).val().trim()||($(d).hasClass("chkBox")?$(d).ruiCheckbox("getCheckedValue"):"");e&&a.validators&&a.validators[c]?a.validators[c](e)&&(f=FormInputStates.VALID):e&&(f=FormInputStates.VALID);a.formUtils.setPolyfillAttributeValue(d,PolyfillAttributes.STATE,f)}});this.toggleSubmitButton(a)},validateFormInput:function(a,
b,c){var d=document.querySelector("form#"+a.formName+" #"+b);if($(d).is(":visible")){var f=$(d).val().trim(),e=null,g=this.getErrorDivId(d.id);$("#"+g).html(emptyMap[b]);a.validators&&a.validators[b]?e=a.validators[b](f)?FormInputStates.VALID:this.canShowErrorFromValidators(a,b,f,c)?FormInputStates.ERROR:FormInputStates.INACTIVE:f?e=FormInputStates.VALID:0<=a.mandatoryFields.indexOf(b)&&(e=c?FormInputStates.ERROR:FormInputStates.INACTIVE);null!==e&&a.formUtils.setPolyfillAttributeValue(d,PolyfillAttributes.STATE,
e);a.formType==FormType.PROACTIVE&&this.performBasicValidations(a,b,c);a.formUtils.adjustFieldAppearance(b,e,g)}},canShowErrorFromValidators:function(a,b,c,d){return d&&(0<=a.mandatoryFields.indexOf(b)||c&&"default"!==c)?!0:!1},validateFormCheckboxInputOnStateChange:function(a,b){var c=document.querySelector("form#"+a.formName+" #"+b);if($(c).is(":visible")){var d=this.getErrorDivId(c.id);$("#"+d).html(emptyMap[b]);var f=null,f=""===$("form#"+a.formName+" #"+b).ruiCheckbox("getCheckedValue")?FormInputStates.VALID:
FormInputStates.ERROR;null!==f&&a.formUtils.setPolyfillAttributeValue(c,PolyfillAttributes.STATE,f);a.formUtils.adjustFieldAppearance(b,f,d)}},performBasicValidations:function(a,b){var c=document.querySelector("form#"+a.formName+" #"+b),d=$(c).val().trim();if(a.formUtils.getPolyfillAttributeValue(c,PolyfillAttributes.STATE)===FormInputStates.INACTIVE){var f=!1;a.basicValidators&&(a.basicValidators[b]&&a.basicValidators[b](d))&&(f=!0);a.formUtils.setPolyfillAttributeValue(c,PolyfillAttributes.BASIC_VALIDATION_PASSED,
f)}},sanitizeFieldValue:function(a,b){var c=$("form#"+a.formName).find("#"+b);if("password"!==c.attr("type")){var d=c.val().trim();2<d.length&&(-1!=d.indexOf("<")&&-1!=d.indexOf(">"))&&(d=d.replace(/</g,""),d=d.replace(/>/g,""));c.val(d)}},attachFormInputBlurHandler:function(a){var b=this;jQuery.each(a.fields,function(c,d){$("form#"+a.formName).find("#"+d).on("blur",function(c){var e=this.id;$("#"+e).val().trim()||$(this).parent().find("#lbl"+d).removeClass("small-text").addClass("regular-text");
a.formUtils.floatLabel(e);b.validateFormInput(a,e,!0);b.performTracking(a,e);b.sanitizeFieldValue(a,e);"undefined"!==typeof ajaxMode[e]&&b.triggerAjax(e,ajaxMode[e]);b.toggleSubmitButton(a);c.stopImmediatePropagation()})})},attachFormInputFocusHandler:function(a){var b=this;jQuery.each(a.fields,function(c,d){$("form#"+a.formName).find("#"+d).on("focus",function(c){$(this).parent().addClass("expanded");$(this).parent().find("#lbl"+d).removeClass("regular-text").addClass("small-text");var e=b.getErrorDivId(this.id);
a.formUtils.getPolyfillAttributeValue(this,PolyfillAttributes.STATE)===FormInputStates.ERROR?($(this).attr("aria-invalid","true"),$(this).attr("aria-describedby",e)):($(this).attr("aria-invalid","false"),$(this).attr("aria-describedby",""));c.stopImmediatePropagation()})})},attachFormInputKeyPressHandler:function(a){var b=this;jQuery.each(a.fields,function(c,d){$("form#"+a.formName).find("#"+d).on("keypress",function(c){c.which===a.keys.ENTER&&(b.validateFormInput(a,this.id,!0),b.performTracking(a,
this.id),"undefined"!==typeof isSubmitValidationOn&&isSubmitValidationOn?(b.submitForm(a),"undefined"!==typeof ajaxMode[this.id]&&(b.sanitizeFieldValue(a,this.id),b.triggerAjax(this.id,ajaxMode[this.id])),b.toggleSubmitButton(a)):(b.toggleSubmitButton(a),b.submitForm(a)));c.stopImmediatePropagation()})})},attachFormCheckboxInputHandlers:function(a){var b=this;jQuery.each(a.mandatoryFields,function(c,d){$("form#"+a.formName).find("#"+d).hasClass("chkBox")&&($("form#"+a.formName).find("#"+d).find("li>span.chk-lb").on("keydown",
function(c){c.which===a.keys.TAB?(b.validateFormInput(a,d,!0),b.toggleSubmitButton(a)):c.which===a.keys.SPACE&&(b.validateFormCheckboxInputOnStateChange(a,d),b.toggleSubmitButton(a))}),$("form#"+a.formName).find("#"+d).find("li>span").on("click",function(){b.validateFormCheckboxInputOnStateChange(a,d);b.toggleSubmitButton(a)}))})},attachFormInputKeyUpHandler:function(a){var b=this;jQuery.each(a.fields,function(c,d){$("form#"+a.formName).find("#"+d).on("input keyup",function(c){if(!(c.shiftKey&&c.which===
a.keys.TAB)&&c.which!==a.keys.TAB&&c.which!==a.keys.SHIFT&&c.which!==a.keys.ENTER&&0>d.indexOf("PASSWORD")){a.formUtils.floatLabel(d);var e=$("#"+this.id).val();if(a.previousFormFieldValues[this.id]===e)return c.stopImmediatePropagation(),!1;a.previousFormFieldValues[this.id]=e;b.validateFormInput(a,this.id,!1);b.toggleSubmitButton(a);c.stopImmediatePropagation()}})})},performTracking:function(a,b){if(a.formUtils.isFieldNonEmpty($("#"+b))){var c=$("#"+b).attr("t");"1"===$("#"+b).attr("toc")&&"undefined"!==
typeof trackFld?$("#"+b).val()!==a.initialFormFieldValues[b]&&(a.formUtils.populateUrl(b,a.trackingInfo),$("#"+b).attr("toc","0")):"1"==c&&("undefined"!=typeof trackFld&&trackFld)&&a.formUtils.populateUrl(b,a.trackingInfo)}},handleTrackOnChangeFields:function(a){a.initialFormFieldValues={};$("form#"+a.formName).find("[toc=1]").each(function(b,c){a.initialFormFieldValues[c.id]=$(c).val()});raptor.require("raptor/pubsub").subscribe("reg.updateTrackOnChangeFieldValues",function(b){jQuery.each(b,function(b,
d){var f=$("#"+d);a.initialFormFieldValues[f.attr("id")]=$(f).val()})})},triggerAjax:function(a,b){var c=this,d=this.cfg.formUtils,f=this.cfg.trackingUtils,e=this.cfg;$("#"+a).val().trim()&&(d.triggerAjaxWithHandler(a,b,null,function(b){e.validationCallTimeout=null;e.validationAjaxStarted=!1;c.clearErrors(a);b.buyerLogEvent&&f.dropBuyerLogEvent(b.buyerLogEvent);b.content&&jQuery.each(b.content,function(a,b){var e=c.getErrorDivId(a);$("#"+e).html(b);d.setPolyfillAttributeValue(document.getElementById(a),
PolyfillAttributes.STATE,FormInputStates.ERROR);d.adjustFieldAppearance(a,FormInputStates.ERROR,e);raptor.require("raptor/pubsub").publish("reg.inputStateChanged")});e.validationHappeningForSubmit&&c.submitFormAfterValidation(e,b.content)},e.validationCallTimeout,null,this.cfg.trackingInfo),e.validationAjaxStarted=!0)},clearErrors:function(a){switch(a){case "city":case "zip":case "state":var b=this.cfg.formUtils;if(a=ajaxFlds[a])for(var c=0,d=a.length;c<d;c++)if($("#"+a[c]).val().trim()){var f=this.getErrorDivId(a[c]);
b.setPolyfillAttributeValue(document.getElementById(a[c]),PolyfillAttributes.STATE,FormInputStates.VALID);b.adjustFieldAppearance(a[c],FormInputStates.VALID,f);raptor.require("raptor/pubsub").publish("reg.inputStateChanged")}}},getErrorDivId:function(a){var b=this.cfg,c=a+"_w";b.errorDivs&&b.errorDivs[a]&&(c=b.errorDivs[a]);return c},attachFormInputStateChangeHandler:function(a){var b=this;raptor.require("raptor/pubsub").subscribe("reg.inputStateChanged",function(){b.toggleSubmitButton(a)})},toggleSubmitButton:function(a){if(a.formType===
FormType.PROACTIVE&&!a.formSubmitted){var b=$("form#"+a.formName).find("[data-state='inactive']"),c=$("form#"+a.formName).find("[data-state='error']"),d=b.length;0<d&&jQuery.each(b,function(b,c){"true"===a.formUtils.getPolyfillAttributeValue(c,PolyfillAttributes.BASIC_VALIDATION_PASSED)&&d--});c.length||d?($("#"+a.submitBtn).attr("disabled","disabled"),$("#"+a.submitBtn).attr("aria-describedby",a.submitBtn+"DisabledText")):($("#"+a.submitBtn).removeAttr("disabled"),$("#"+a.submitBtn).removeAttr("aria-describedby"),
$("#"+a.submitBtn).removeClass("btn-d"))}},attachFormSubmitButtonFocusHandler:function(a){$("#"+a.submitBtn).on("focus",function(){var b="";$(".agsp, .vp, .agmtText").filter(":visible").each(function(){var a=$(this).clone();$(".g-hdn",a).remove();b+=a.text()});a.formUtils.notifyScreenReader(b)})},attachFormSubmitHandler:function(a){var b=this,c=a.formUtils;$("#"+a.submitBtn).on("click",function(){var d=$("form#"+a.formName).find("[data-state='inactive']");d.length&&jQuery.each(d,function(d,e){"true"===
c.getPolyfillAttributeValue(e,PolyfillAttributes.BASIC_VALIDATION_PASSED)&&b.validateFormInput(a,e.id,!0)});b.toggleSubmitButton(a);return b.submitForm(a)});$("#"+a.submitBtn).on("mousedown",function(a){(1==a.which||1==a.button)&&$(this).click()})},submitFormWaitForValidation:function(a){var b=this;a.validationCallTimeout=500;a.validationHappeningForSubmit=!0;setTimeout(function(){if(!a.validationAjaxStarted)return b.submitFormAfterValidation(a,null)},100);return!1},submitFormAfterValidation:function(a,
b){a.validationHappeningForSubmit=!1;var c=!0;b&&jQuery.each(b,function(a){if("undefined"!==typeof ajaxMode[a])return c=!1});if(c){var d=$("#"+a.submitBtn).css("background-color");$("#"+a.submitBtn).css("color",d);submitValidationSucceeded=!0;a.formSubmitted=!0;$("#"+a.formName).submit();return!0}submitValidationSucceeded=a.formSubmitted=!1;$("#"+a.formName).find("#throbber").addClass("hdn");return!1},submitForm:function(a){if(a.formType===FormType.REACTIVE&&!this.validateAllFormFields(a))return!1;
if(!a.formSubmitted&&$("#"+a.submitBtn).is(":enabled")){a.formSubmitted=!0;$("#statErr").is(":visible")&&$("#statErr").hide();var b=a.submitBtn;$("#"+a.submitBtn).attr("disabled","disabled");$("#"+a.formName).find("#throbber").css("left",$("#"+b).width()/2+$("#"+b).offset().left+"px");$("#"+a.formName).find("#throbber").removeClass("hdn");if("undefined"!==typeof isSubmitValidationOn&&isSubmitValidationOn&&!a.validationHappeningForSubmit)return this.submitFormWaitForValidation(a);var c=$("#"+b).css("background-color");
$("#"+b).css("color",c);$("#"+a.formName).submit();return!0}return!1},validateAllFormFields:function(a){var b=this,c=$("form#"+a.formName).find("[data-state='inactive']");c.length&&jQuery.each(c,function(c,f){b.validateFormInput(a,f.id,!0)});c=$("form#"+a.formName).find("[data-state='error']:visible");return c.length?($("#statErr").find("#errList").find("li").remove(),jQuery.each(c,function(b,c){var e=c.id;a.aliasFieldsForStatusErr&&a.aliasFieldsForStatusErr[e]&&(e=a.aliasFieldsForStatusErr[e]);var g=
$("form#"+a.formName).find("label[for='"+e+"']").text();a.formUtils.appendToStatusErrorMessage(e,g)}),$("#addressRetrieveErr").is(":visible")&&$("#addressRetrieveErr").hide(),$("#statErr").show(),$("#ertx").focus().focus(),!1):!0}};return h});raptor.defineClass("TrackingUtils",function(){var f=["address1","address2","state","city","zip"],g={69:"ReclaimPageLoad",71:"ReclaimEmailBtnClick",63:"UserNameSaved"},h={birthdate3:"dateofbirth",PASSWORD:"password",PASSWORD_BIZREG:"businesspassword",phoneFlagComp1:"phone",phoneFlagComp1Business:"businessphone",PASSWORDEBAY:"password"};return{triggerRegTracking:function(a,c,d){var b={mode:1};if(c){var e=h[c];b.fieldName=e?e:c}d&&(b.eventId=d);"undefined"==typeof c&&"undefined"==typeof d?b.eventType=
"PageLoad":d?b.eventType=g[d]:0<=$.inArray(c,f)&&"true"===$("#addressSelectedFromSugg").val()&&(b.eventType="AddressSuggesstionEdit");"undefined"==typeof b.eventType&&(b.eventType="FieldEdit");if("undefined"!=typeof isBizUser&&isBizUser||"true"==$("#bizFlag").val())b.usrDesgn="2";isMobile&&(b.mobile="1");a&&(a.sourcePageId&&(b.srcPage=a.sourcePageId),a.srcAppId&&(b.srcAppId=a.srcAppId));a="";"undefined"!==typeof trackingSrt&&(a=trackingSrt);$.ajax({url:"track",headers:{srt:a},type:"POST",data:b})},
dropBuyerLogEvent:function(a){a=logurl+"&eventid="+a+"&ord="+(new Date).getTime()+"&src=rap";isMobile&&-1==a.indexOf("&mobile=1")&&(a+="&mobile=1");if("undefined"!=typeof isBizUser&&isBizUser||"true"==$("#bizFlag").val())a+="&usrDesgn=2";"undefined"!=typeof guestReg&&(1==guestReg&&-1==a.indexOf("&reggstpage=1"))&&(a+="&reggstpage=1");$("#track").attr("src",a)}}});raptor.defineClass("FormUtils",function(){var g=new (raptor.require("TrackingUtils")),f={triggerAjaxWithHandler:function(a,b,c,e,f,g,j){var d={},h=ajaxFlds[a],k="undefined"!==typeof ajaxData?ajaxData[a]:null;if(h)for(var i=0,m=h.length;i<m;i++){var n=$("#"+h[i]).val();d[h[i]]=n}if(k)for(var l in k)d[l]=k[l];d.mode=b;d.eId=a;d.track=c;if("undefined"!=typeof isBizUser&&isBizUser||"true"==$("#bizFlag").val())d.usrDesgn=2;"undefined"!=typeof j&&"undefined"!=typeof j.sourcePageId&&(d.srcPage=j.sourcePageId);
switch(a){case "PASSWORD":case "PASSWORD_BIZREG":case "PASSWORDEBAY":d.eId="PASSWORD";d.PASSWORD=$("#"+a).val();d.pwdMode=0;break;case "email":case "businessemail":d.ru=$("#ru").val();"undefined"!==typeof isUpgradePage&&isUpgradePage&&(d.upgrade="true");isMobile&&(d.srcAppId=$("#srcAppId").val(),d.rmvHdr=$("#rmvHdr").val());if("businessemail"==a||"undefined"!==typeof frmName&&"socialRegForm"==frmName)d.checkForReclaimEmail=!1;break;case "city":case "zip":case "state":if(!$("#city").val()||!$("#zip").val()||
!(0==$("select[id=state]").length||$("#state").val()&&"default"!==$("#state").val()))return}$.ajax({url:"ajax",type:"POST",data:d,timeout:f,success:function(a){e(a,g)},error:function(a,b){"timeout"===b&&e({timeout:!0})}})},populateUrl:function(a,b){g.triggerRegTracking(b,a);if("firstname"==a)var c=!0;else if("lastname"==a)var e=!0;"lastname"==a&&c||"firstname"==a&&e?$(a).attr("t","0"):(("undefined"==typeof b||"true"!==b.isRaptorRegTrack)&&"undefined"!==typeof trackFld&&"undefined"!==typeof trackFld[a]&&
g.dropBuyerLogEvent(trackFld[a]),$("#"+a).attr("t",0))},notifyScreenReader:function(a,b){0==$("#screenReaderStatus").length&&$('<div id="screenReaderStatus" aria-live="polite" class="g-hdn"></div>').appendTo("body");var c=$("#screenReaderStatus"),a=$.trim(a),b=b||50;0===b?c.html(a):window.setTimeout(function(){c.html(a)},b)},adjustFieldAppearance:function(a,b,c){var e=$("#"+a);"error"===b?(e.parent().addClass("fv-err"),$("#"+c).prop("class","fv-et")):(e.parent().removeClass("fv-err"),e.parent().parent().hasClass("fv-err")?
e.parent().parent().removeClass("fv-err"):$("#"+a).parent().parent().parent().hasClass("fv-err")&&e.parent().parent().parent().removeClass("fv-err"),$("#"+c).prop("class","rdn"))},floatLabel:function(a){var b=$("#"+a);b.is("input")&&((a=f.isFieldNonEmpty("#"+a))&&!b.parent().hasClass("expanded")?b.parent().addClass("expanded"):!a&&b.parent().hasClass("expanded")&&b.parent().removeClass("expanded"))},isFieldNonEmpty:function(a){if($(a).is("input"))return $(a).val().trim();if($(a).is("select"))return!f.doesDropdownHaveDefaultSelection(a)},
getPolyfillAttributeValue:function(a,b){return a?void 0!==a.dataset?a.dataset[b]:a.getAttribute("data-"+b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()):null},setPolyfillAttributeValue:function(a,b,c){a&&(void 0!==a.dataset?a.dataset[b]=c:a.setAttribute("data-"+b.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),c));return null},appendToStatusErrorMessage:function(a,b){var c="er_"+a;$("#"+c).is(":visible")||($("#"+a).hasClass("chkBox")?$("#errList").append('<li id="'+c+'"><a href="javascript:void(0);" onclick="$(\'#'+
a+" li>span.chk-lb').focus();\">"+b+"</a></li>"):$("#errList").append('<li id="'+c+'"><a href="javascript:void(0);" onclick="$(\'#'+a+"').focus();\">"+b+"</a></li>"),$("#"+c).show())},changeLinkToSpan:function(){var a=$("a#ebayCompaniesLink"),b=$("<span>");a.after(b.html(a.html())).remove()},handleEbayCompaniesLinkPress:function(){$("span#ebayCompanies").html($("span#ebayCompaniesDup").html());$("span#ebayCompanies").removeClass("dspNone");f.changeLinkToSpan();"undefined"!=typeof ppaRegSir&&ppaRegSir.chngHt();
$("span#ebayCompanies").focus()},attachHandlersForEbayCompaniesLink:function(){$("a#ebayCompaniesLink").click(function(){f.handleEbayCompaniesLinkPress();return!1});$("li>span.chk-lb").on("keydown",function(a){if("ebayCompaniesLink"==a.target.id&&(32==a.keyCode||13==a.keyCode))return f.handleEbayCompaniesLinkPress(),!1})},showLabelsWhenPlaceholderUnsupported:function(){jQuery.support.placeholder=!1;test=document.createElement("input");"placeholder"in test&&(jQuery.support.placeholder=!0);if(!$.support.placeholder){document.documentElement.focus();
var a=document.activeElement;$("input[placeholder],select[placeholder]").each(function(){var a=$("#lbl"+this.id);a&&a.attr("class","");$(this).parent().parent().parent().hasClass("autocompleteCntr")&&$(this).parent().parent().parent().find("label.g-hdn ~ input").attr("style","top: 21px !important;")});$(a).focus()}},doesDropdownHaveDefaultSelection:function(a){return"default"===$(a).val()||$(a).attr("id").startsWith("birthdate")&&("0"===$(a).val()||"00"===$(a).val()||"999999"===$(a).val())},setDropdownColor:function(a){f.doesDropdownHaveDefaultSelection(a)?
$(a).attr("style",""):$(a).attr("style","color:#333 !important;")}};return f});raptor.defineClass("regOpt.PartialRegFieldValidators",function(){return{validators:{email:function(a){return a&&1<=a.length},PASSWORD:function(){var a=new (raptor.require("FormUtils")),b=a.getPolyfillAttributeValue(document.getElementById("PASSWORD"),PolyfillAttributesInPwd.RULES_PASSED),a=a.getPolyfillAttributeValue(document.getElementById("PASSWORD"),PolyfillAttributesInPwd.REQUIRED_RULES);return parseInt(b)===parseInt(a)},captcha_Ipt:function(a){return a&&6===a.length&&!isNaN(a)},acceptq1:function(){return"on"===
$("#acceptq1").ruiCheckbox("getCheckedValue")},promotion:function(){return"on"===$("#promotion").ruiCheckbox("getCheckedValue")}},attachAdditionalHandlers:function(){$("#promotion").is(":visible")&&($("#promotion").ruiCheckbox(),$("#promotion").find("li>span").on("click",function(){"on"===$("#promotion").ruiCheckbox("getCheckedValue")?$(document).trigger("rover",{sid:"p2052190:l9371",marketingOptIn:"UNCHECKED"}):$(document).trigger("rover",{sid:"p2052190:l9371",marketingOptIn:"CHECKED"})}));$("#acceptq1").is(":visible")&&
$("#acceptq1").ruiCheckbox();$("a#ebayCompaniesLink").is(":visible")&&(new (raptor.require("FormUtils"))).attachHandlersForEbayCompaniesLink()}}});var RegUtil=function(){function b(a,c){var d="maxlength name value id size class autocomplete autocorrect a v t oncopy onpaste placeholder style data-state".split(" ");$(a).on("checkboxClick",function(){if("Password"!=$("input#PASSWORD").val()){for(var a=$(this).ruiCheckbox("getCheckedValue")?"text":"password",a=$('<input type="'+a+'" />'),b=0;b<d.length;b++)a.attr(d[b],$(c).attr(d[b]));try{var e=$(c).data("events"),g;for(g in e)for(var f in e[g])a[g](e[g][f].handler)}catch(i){}$(c).replaceWith(a)}})}
var f;return{init:function(a){window.isMobile="true"===window.isMobile||!0===window.isMobile;f=countryId;switch(a.regType){case "jointreg1":b("#showPassword","#PASSWORD");frmName="jointRegForm";break;case "jointreg2":frmName="jointRegForm";break;case "guestregrevised":b("#showPASSWORDEBAY","#PASSWORDEBAY");b("#showPASSWORDPAYPAL","#PASSWORDPAYPAL");b("#showPassword","#PASSWORD");frmName="guestRegForm";break;case "partialreg":"undefined"!==typeof a.passwordId?b("#show"+a.passwordId,"#"+a.passwordId):
b("#showPASSWORD","#PASSWORD")}a=!0;switch(parseInt(f)){case 77:case 2:case 15:a=!1}$("#promotion:visible").attr("checked",a);$("#userid,#email,#PASSWORDEBAY, #PASSWORDPAYPAL, #dayUsph, #dayphone1,  #dayphone2").filter(":visible").on("focus blur",function(a){var d=this.id,d="dayphone2"==d?d.replace("2","1"):d;"focus"==a.type?$("#"+d+"_id").css({display:"block"}):$("#"+d+"_id").css({display:"none"})})},passwordMeter:{toggle:function(a,c){var d;d=-1<a.indexOf("PASSWORD")?$("#"+a).closest(".credential"):
$(".pgWidth");d.find(".pass_st").toggle(0<$("#"+a).val().length||d.find(".re-p9").is(":visible"));"undefined"!=typeof c&&(d.find(".txt").html(c),d.find(".pwds").prop("class","pwds rg-i pg-i").addClass(pwdMeter[c]),0<$("#isPpUpSell").length&&(0==$("#"+a).val().length?($("#ptck").prop("class"," rfl"),setClass(a,!1)):isInvTxt==c||tooSh==c||pwdSgth==c?$("#ptck").prop("class"," rfl"):($("#ptck").prop("class"," rfl ptic"),setClass(a,!1))))}},validation:{showError:function(a){var c=a.content;null!=c&&$.each(c,
function(a,c){(1==countryId||2==countryId)&&-1!=a.indexOf("dayphone")?(errFld="#dayUsph_w",a="dayUsph"):errFld="#"+a+"_w";$(errFld).html(c);setClass(a,!0)});if(a.success)switch(parseInt(a.mode)){case 3:for(a=0;a<addGrp.length;a++)setClass(addGrp[a],!1);break;case 5:1===parseInt(a.guest)?$("#isGuest").val("1"):0===parseInt(a.guest)&&$("#isGuest").val("0")}}},ajax:{trigger:function(a,c,d){var b="ajax",f=location.href,e={mode:c,eId:a},g=ajaxFlds[a];if(g)for(var h=0,i=g.length;h<i;h++)e[g[h]]=$("#"+g[h]).val();
(15==c||17==c)&&$("#"+frmName).find("input,select").each(function(){var a=this.value;"checkbox"==this.type&&(a=$(this).is(":checked"));e[this.name]=a});switch(a){case "PASSWORD":case "PASSWORDEBAY":case "PASSWORDPAYPAL":e.eId="PASSWORD",e.PASSWORD=$("#"+a).val(),e.pwdMode=0,0<$("#isPpUpSell").length&&"PASSWORDEBAY"!=a&&(e.pwdMode=1)}d&&(e.track=!0);-1!=f.indexOf("ws/eBayISAPI.dll?GuestReg")&&($("#olduserid")&&$("#olduserid").val())&&(b="Guestajax");$.ajax({url:b,type:"POST",data:e,success:function(b){c=
parseInt(b.mode);switch(c){case 0:case 7:case 16:userIdAjaxResponseHandler(b,c);break;case 6:RegUtil.passwordMeter.toggle(a,b.pwdMeter);d&&setErrOnBlur(a,b.pwdMeter);break;case 11:(1==countryId||77==countryId)&&showZipSugg(b);break;case 12:(1==countryId||77==countryId)&&populateCityState(b);break;case 15:guestResponseHandler(b);break;case 17:ppUpsellResponseHandler(b);break;default:showErrors(b)}}})}},validateMismatch:function(){var a=$("#rpass")[0];a&&(a.value&&0<a.value.length)&&validateMismatch("rpass",
!0)}}}(),RegConfig=function(){return{init:function(){this.ajaxFlds={firstname:["firstname","lastname","countryId"],lastname:["firstname","lastname","countryId"],st_ct:"address1 address2 city state zip countryId".split(" "),email:["email","countryId"],businessemail:["businessemail","countryId"],userid:"firstname lastname email userid zip countryId".split(" "),PASSWORD:["PASSWORD","email","userid","countryId"],PASSWORDEBAY:["PASSWORD","email","userid","countryId"],PASSWORDPAYPAL:["PASSWORD","email",
"userid","countryId"],rpass:["PASSWORD","rpass","email","userid","countryId"],SECRET_ANSWER:"PASSWORD email userid SECRET_QUESTION SECRET_ANSWER countryId".split(" "),dayUsph:["dayUsph","dayphone1","dayphone2","dayphone3","countryId"],zip:["zip","countryId"]};this.ajaxMode={firstname:"1",lastname:"2",st_ct:"3",dayUsph:"4",email:"5",PASSWORD:"6",userid:"7",rpass:"8",SECRET_ANSWER:"9",PASSWORDEBAY:6,PASSWORDPAYPAL:6};this.chgCtry="chgCtry";this.frmaction="frmaction";this.frmName="jointRegForm";this.bzFrmName=
"BusinessRegistration";this.nameGrp=["firstname","lastname","countryId"];this.emailGrp=["email","countryId"];this.pwdGrp=["PASSWORD","email","userid","countryId"];this.rpwdGrp=["PASSWORD","rpass","email","userid","countryId"];this.userIdGrp="firstname lastname email userid zip countryId".split(" ");this.sqGrp="PASSWORD email userid SECRET_QUESTION SECRET_ANSWER countryId".split(" ");this.zpGrp=["zip","countryId"];this.addGrp="address1 address2 city state zip countryId".split(" ");this.validateFld=
{rpass:pwdFld};switch(primaryPhoneFormat){case "ALLINONEFORMAT":phGrp=["dayphone1","countryId"];phAjx="dayphone1";break;case "AREACODEEXCHANGENUM":phGrp=["dayUsph","dayphone1","dayphone2","dayphone3","countryId"];phAjx="dayUsph";break;default:phGrp=["dayphone1","dayphone2","countryId"],phAjx="dayphone2"}this.errPos={firstname:180,lastname:180,address1:230,zip:270,email:360,businessemail:360,st_ct:270,city:270,state:270,acceptq1:550,dayUsph:460,dayphone1:460,userid:500,PASSWORD:520,rpass:550,SECRET_QUESTION:590,
SECRET_ANSWER:660,birthdate1:850,birthdate2:850};this.trackFld={lastname:25,userid:28,firstname:25,PASSWORD:29,email:27,businessemail:27,remail:64,rpass:29,address1:34,dayUsph:26,dayphone1:26,dayphone2:26,SECRET_ANSWER:35,birthdate3:36,acceptq1:37,cksbtBtn:38,PASSWORDEBAY:29,PASSWORDPAYPAL:52};switch(countryId){case 77:addGrp=["address1","address2","city","zip","countryId"]}}}}(),JointRegUtil=function(){return{showConfirmation:function(b,f){var a=$("#confirmationContent").show(),c=$("#confirmEbay_wrp"),
d=$("#confirmPayPal_wrp");$("#jointreg").hide();c.find(".success").toggle(b);c.find(".error").toggle(!b);d.find(".success").toggle(f);d.find(".error").toggle(!f);b&&f?(a.find(".success_both").show(),$(".not_success_both").hide()):a.find(".success_both").hide()}}}();var regPostMsg=regPostMsg||{};
regPostMsg.XD=function(){var a,e,h=1,f,d=this;return{postMessage:function(c,a,b){b=b||parent;d.postMessage?b.postMessage(c,"*"):a&&(b.location=a.replace(/#.*$/,"")+"#"+ +new Date+h++ +"&"+JSON.stringify(c))},receiveMessage:function(c,g){if(d.postMessage)if(c&&(f=function(b){if("string"===typeof g&&b.origin!==g||"[object Function]"===Object.prototype.toString.call(g)&&!1===g(b.origin))return!1;c(b)}),d.addEventListener)d[c?"addEventListener":"removeEventListener"]("message",f,!1);else d[c?"attachEvent":
"detachEvent"]("onmessage",f);else a&&clearInterval(a),a=null,c&&(a=setInterval(function(){var b=document.location.hash,a=/^#?\d+&/;b!==e&&a.test(b)&&(e=b,c({data:b.replace(a,"")}))},100))}}}();var UrlParser=function(){};UrlParser.getUrlVars=function(a){var e={},a=a||window.location.href;a.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(a,f,d){e[f]=d});return e};raptor.defineClass("reg.MobileUtil",function(){var e={fillData:function(a){if(a){var c={firstname:a.firstname,lastname:a.lastname,address1:a.address1,address2:a.address2,zip:a.zip,city:a.city,state:a.state,countryId:a.countryId};if(a.email){var b="email";"BusinessRegForm"===frmName&&(b="businessemail");c[b]=a.email}a.phone&&(b="phoneFlagComp1","BusinessRegForm"===frmName&&(b="phoneFlagComp1Business"),c[b]=a.phone);if(a.dob)for(var a=a.dob.split("-"),b=0,f=a.length;b<f;b++)c["birthdate"+(b+1)]=a[b];
for(var d in c)e.setFieldValue(d,c[d]);raptor.require("raptor/pubsub").publish("reg.formAutofillFromApp",c)}},setFieldValue:function(a,c){if(c){var b=$("#"+a);b&&0<b.length&&(b.val(),b.val(c),b.blur())}}};return e});$("#ppaBckNav").click(function(a){a.preventDefault();$(document).trigger("rover",{sid:"p2527555.l44597",cancelLink:"clicked"});window.setTimeout(function(){window.history.go(-1)},500)});